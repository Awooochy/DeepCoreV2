using ReMod.Core.VRChat;
using UnityEngine;

namespace DeepCore.Client.Module.Exploits
{
    internal class SpyCamera
    {
        public static GameObject spyCam;
        public static bool isActive = false;
        public static void Toggle(bool state)
        {
            if (state)
            {
                EnableSpyCamera();
            }
            else
            {
                DisableSpyCamera();
            }
        }
        private static void EnableSpyCamera()
        {
            if (spyCam != null) return;
            spyCam = new GameObject("SpyCam");
            Camera cam = spyCam.AddComponent<Camera>();
            cam.fieldOfView = 60f;
            cam.nearClipPlane = 0.1f;
            cam.farClipPlane = 1000f;
            GameObject player = PlayerExtensions.GetVRCPlayer().gameObject;
            if (player != null)
            {
                spyCam.transform.SetParent(player.transform);
                spyCam.transform.localPosition = new Vector3(0, 2, -3);
                spyCam.transform.localRotation = Quaternion.Euler(10, 0, 0);
            }
            isActive = true;
        }
        private static void DisableSpyCamera()
        {
            if (spyCam != null)
            {
                GameObject.Destroy(spyCam);
                spyCam = null;
                isActive = false;
            }
        }
    }
}
